#!/usr/bin/env python
''' given a list of files, extracts variants and outputs unique list '''

from __future__ import print_function
import gzip
import argparse
import json
from os import path


def extract_variants(filename, index):
    ''' extract variants from file and add to variants set'''
    with gzip.open(filename, 'r') as fh:
        for line in fh:
            values = line.split('\t')
            variants.add(values[index])
        


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="extract unique list of variants by comparing files")
    parser.add_argument('-f', '--files', help='json object of file:variant field (index) pairs; e.g. {"file1":4, "file2":1"}', required=True)
    parser.add_argument('-d', '--directory', help="directory for ouptu", required=True)


    args = parser.parse_args()

    files = json.loads(args.files)

    variants = set()
    for f, index in files.iteritems():
        filename = path.join(args.directory, f)
        extract_variants(filename, index)
        

    ofilename = path.join(args.directory, 'unique_variants.txt')
    with open(ofilename, 'w') as of:
        for v in variants:
            print(v, file=of)


    
